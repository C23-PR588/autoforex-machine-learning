# Machine Learning Autoforex-App

Machine Learning for forecasting some currency into Indonesia Rupiah.

## Contributing
Team Machine Learning on :
- [Agung Rashif Madani](https://www.linkedin.com/in/agung-rashif-madani-905b75222/)
- []()

## Dataset
We use API to get the Historical Data from [FreeCurrencyAPI](https://freecurrencyapi.com/)

## Library
Library we use a lot to create the model

```tensorflow
matplotlib.pyplot
pandas
numpy
csv
os
```
    
## Forecasting Currency Exchange Rate to IDR

This forecasting has 10 features currency which is:
- 1: EUR
- 2: USD 
- 3: JPY
- 4: GBP
- 5: SGD
- 6: AUD
- 7: CNY
- 8: CAD 
- 9: MYR
- 10: RUB

We choose 2 best tensorflow models architecture from all possible models we trained. We also choose `Adam` as Optimizer and `Huber` as loss function.
First model is ANN 4 layers with Regularization:
```
def first_model(train_set, valid_set, window_size):
    model = tf.keras.models.Sequential([
        tf.keras.layers.Dense(128, input_shape=[window_size], activation="relu", kernel_regularizer=tf.keras.regularizers.l2(0.01)),
        tf.keras.layers.Dense(64, activation="relu", kernel_regularizer=tf.keras.regularizers.l2(0.01)),
        tf.keras.layers.Dense(32, activation="relu", kernel_regularizer=tf.keras.regularizers.l2(0.01)),
        tf.keras.layers.Dense(1)
    ], name=f"1_model_{currency[0]}")

    # Get initial weights
    init_weights = model.get_weights()

    # Reset states generated by Keras
    tf.keras.backend.clear_session()

    # Reset the weights
    model.set_weights(init_weights)

    model.summary()

    # Initialize the optimizer
    optimizer = tf.keras.optimizers.Adam()

    # Set the training parameters
    model.compile(loss=tf.keras.losses.Huber(),
                    optimizer=optimizer,
                    metrics=["mae"])

    # Train the model
    history = model.fit(train_set,
                          epochs=100,
                          verbose=1,
                          batch_size=batch_size,
                          validation_data=valid_set,
                          callbacks=[create_model_checkpoint()])
    model.evaluate(valid_set)
    plot_loss(history)
    
    return model
```
Second Model is ANN with 4 layers without regularization
```
def second_model(train_set, valid_set, window_size):
    model = tf.keras.models.Sequential([
        tf.keras.layers.Dense(256, input_shape=[window_size], activation="relu"),
        tf.keras.layers.Dense(128, activation="relu"),
        tf.keras.layers.Dense(64, activation="relu"),
        tf.keras.layers.Dense(32, activation="relu"),
        tf.keras.layers.Dense(1)
    ], name=f"2_model_{currency[0]}")

    # Get initial weights
    init_weights = model.get_weights()

    # Reset states generated by Keras
    tf.keras.backend.clear_session()

    # Reset the weights
    model.set_weights(init_weights)

    model.summary()

    # Initialize the optimizer
    optimizer = tf.keras.optimizers.Adam()

    # Set the training parameters
    model.compile(loss=tf.keras.losses.Huber(),
                    optimizer=optimizer,
                    metrics=["mae"])

    # Train the model
    history = model.fit(train_set,
                          epochs=100,
                          verbose=1,
                          batch_size=batch_size,
                          validation_data=valid_set,
                          callbacks=[create_model_checkpoint()])
    model.evaluate(valid_set)
    plot_loss(history)
    
    return model
```

Below are MAE, MSE, RMSE, MAPE, MASE for each currency:

First Model

![image](https://github.com/C23-PR588/autoforex-machine-learning/assets/121701309/af85c3bf-dbbb-4801-952d-0dff0cb6d05b)

Second Model

![image](https://github.com/C23-PR588/autoforex-machine-learning/assets/121701309/74a13d86-2eed-47dc-a5d6-36297be9f13d)

Forecasting 10 days futures ahead

Based on the evaluation,
##### EUR/IDR
![image](https://github.com/C23-PR588/autoforex-machine-learning/assets/121701309/48fa043d-4623-4b25-ba0f-fb267db9fd66)
##### USD/IDR
![image](https://github.com/C23-PR588/autoforex-machine-learning/assets/121701309/10576ca6-7389-4f17-8a40-cb7bafc6f335)
##### JPY/IDR
![image](https://github.com/C23-PR588/autoforex-machine-learning/assets/121701309/972c5813-ece2-49d9-bb5d-f937197640e3)
##### GBP/IDR
![image](https://github.com/C23-PR588/autoforex-machine-learning/assets/121701309/886c7d5c-0b4a-4343-a4ba-7b1afba3c868)
##### SGD/IDR
![image](https://github.com/C23-PR588/autoforex-machine-learning/assets/121701309/f67f8a5c-e4b9-4875-b417-d4fa75423e2d)
##### AUD/IDR
![image](https://github.com/C23-PR588/autoforex-machine-learning/assets/121701309/bea69bf2-fa9a-4228-8c19-ba2ce9578b5d)
##### CNY/IDR
![image](https://github.com/C23-PR588/autoforex-machine-learning/assets/121701309/0d118b43-d605-49a9-be36-1735826e93a2)
##### CAD/IDR
![image](https://github.com/C23-PR588/autoforex-machine-learning/assets/121701309/890aa3ac-5874-4467-82d2-eb77d6cc4ad9)
##### MYR/IDR
![image](https://github.com/C23-PR588/autoforex-machine-learning/assets/121701309/c5063f45-5701-4a07-9efe-40ebaaa8cac8)
##### RUB/IDR
![image](https://github.com/C23-PR588/autoforex-machine-learning/assets/121701309/bcc1f895-01e6-4182-949d-35a6e56f9301)

